# CVE-2023-38759 - Cross-Site Request Forgery (CSRF) via Email & Password Reset

|                 |                                                                                      |
| --------------- | --------------- |
| Researchers     | Rowan Crowley                                                               |
| Severity        | TBD                                   |
| Published       | TBD         |
| Software Link   | https://github.com/wger-project/wger             |

## Description
A cross-site request forgery (CSRF) vulnerability in wger Workout Manager v2.2.0a3 allows remote attackers to gain privileges via email change and password reset functionality at /en/user/preferences, /en/gym/user/1/reset-user-password, and /en/user/password/reset/. CSRF through a compromised user session (potentially via XSS from CVE-2023-38758) can be used to (1) immediately reset the user's password (if the user is admin) and (2) change the user's email address (for any user, which can then be used to reset its password). These attacks all occur without additional authentication to the vulnerable application component. Via the user-management feature, CSRF against the admin can reset their own password to a randomly-generated password (which immediately logs them out). For other users, CSRF can be used to change their email address, which can be subsequently used to request a password reset token and take over their account. These attack vectors can allow any account to be compromised, with resulting data exfiltrated back to the attacker's server.

## Proof of Concept
See wgerPOC.py within CVE-2023-38758. This demonstrates CVE-2023-38759 as well as the initial XSS vector from CVE-2023-38758.
